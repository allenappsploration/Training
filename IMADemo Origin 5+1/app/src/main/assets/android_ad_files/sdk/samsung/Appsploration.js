var Kinetic={};
(function(){Kinetic.version="4.5.3";Kinetic.Filters={};Kinetic.Node=function(a){this._nodeInit(a)};Kinetic.Shape=function(a){this._initShape(a)};Kinetic.Container=function(a){this._containerInit(a)};Kinetic.Stage=function(a){this._initStage(a)};Kinetic.Layer=function(a){this._initLayer(a)};Kinetic.Group=function(a){this._initGroup(a)};Kinetic.Global={stages:[],idCounter:0,ids:{},names:{},shapes:{},isDragging:function(){var a=Kinetic.DD;return a?a.isDragging:!1},isDragReady:function(){var a=Kinetic.DD;
return a?!!a.node:!1},_addId:function(a,b){void 0!==b&&(this.ids[b]=a)},_removeId:function(a){void 0!==a&&delete this.ids[a]},_addName:function(a,b){void 0!==b&&(void 0===this.names[b]&&(this.names[b]=[]),this.names[b].push(a))},_removeName:function(a,b){if(void 0!==a){var c=this.names[a];if(void 0!==c){for(var d=0;d<c.length;d++)c[d]._id===b&&c.splice(d,1);0===c.length&&delete this.names[a]}}}}})();
(function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.returnExports=b()})(this,function(){return Kinetic});
(function(){Kinetic.Collection=function(){var a=[].slice.call(arguments),b=a.length,c=0;for(this.length=b;c<b;c++)this[c]=a[c];return this};Kinetic.Collection.prototype=[];Kinetic.Collection.prototype.each=function(a){for(var b=0;b<this.length;b++)a(this[b],b)};Kinetic.Collection.prototype.toArray=function(){for(var a=[],b=0;b<this.length;b++)a.push(this[b]);return a};Kinetic.Collection.mapMethods=function(a){var b=a.length,c;for(c=0;c<b;c++)(function(c){var b=a[c];Kinetic.Collection.prototype[b]=
function(){var a=this.length,c;args=[].slice.call(arguments);for(c=0;c<a;c++)this[c][b].apply(this[c],args)}})(c)}})();
(function(){Kinetic.Transform=function(){this.m=[1,0,0,1,0,0]};Kinetic.Transform.prototype={translate:function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b;this.m[5]+=this.m[1]*a+this.m[3]*b},scale:function(a,b){this.m[0]*=a;this.m[1]*=a;this.m[2]*=b;this.m[3]*=b},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.m[1]*b+this.m[3]*a,d=this.m[0]*-a+this.m[2]*b,e=this.m[1]*-a+this.m[3]*b;this.m[0]=this.m[0]*b+this.m[2]*a;this.m[1]=c;this.m[2]=d;this.m[3]=e},getTranslation:function(){return{x:this.m[4],
y:this.m[5]}},skew:function(a,b){var c=this.m[1]+this.m[3]*b,d=this.m[2]+this.m[0]*a,e=this.m[3]+this.m[1]*a;this.m[0]+=this.m[2]*b;this.m[1]=c;this.m[2]=d;this.m[3]=e},multiply:function(a){var b=this.m[1]*a.m[0]+this.m[3]*a.m[1],c=this.m[0]*a.m[2]+this.m[2]*a.m[3],d=this.m[1]*a.m[2]+this.m[3]*a.m[3],e=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],f=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=this.m[0]*a.m[0]+this.m[2]*a.m[1];this.m[1]=b;this.m[2]=c;this.m[3]=d;this.m[4]=e;this.m[5]=f},invert:function(){var a=
1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=-this.m[1]*a,c=-this.m[2]*a,d=this.m[0]*a,e=a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),f=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*a;this.m[1]=b;this.m[2]=c;this.m[3]=d;this.m[4]=e;this.m[5]=f},getMatrix:function(){return this.m}}})();
(function(){var a=Math.PI/180,b=180/Math.PI,c={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},d=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;Kinetic.Util={_isElement:function(a){return!!a&&1==a.nodeType},
_isFunction:function(a){return!!(a&&a.constructor&&a.call&&a.apply)},_isObject:function(a){return!!a&&a.constructor==Object},_isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)},_isNumber:function(a){return"[object Number]"==Object.prototype.toString.call(a)},_isString:function(a){return"[object String]"==Object.prototype.toString.call(a)},_hasMethods:function(a){var c=[],b;for(b in a)this._isFunction(a[b])&&c.push(b);return 0<c.length},_isInDocument:function(a){for(;a=
a.parentNode;)if(a==document)return!0;return!1},_getXY:function(a){if(this._isNumber(a))return{x:a,y:a};if(this._isArray(a))if(1===a.length){a=a[0];if(this._isNumber(a))return{x:a,y:a};if(this._isArray(a))return{x:a[0],y:a[1]};if(this._isObject(a))return a}else{if(2<=a.length)return{x:a[0],y:a[1]}}else if(this._isObject(a))return a;return null},_getSize:function(a){if(this._isNumber(a))return{width:a,height:a};if(this._isArray(a))if(1===a.length){a=a[0];if(this._isNumber(a))return{width:a,height:a};
if(this._isArray(a)){if(4<=a.length)return{width:a[2],height:a[3]};if(2<=a.length)return{width:a[0],height:a[1]}}else if(this._isObject(a))return a}else{if(4<=a.length)return{width:a[2],height:a[3]};if(2<=a.length)return{width:a[0],height:a[1]}}else if(this._isObject(a))return a;return null},_getPoints:function(a){if(void 0===a)return[];if(this._isArray(a[0])){for(var c=[],b=0;b<a.length;b++)c.push({x:a[b][0],y:a[b][1]});return c}if(this._isObject(a[0]))return a;c=[];for(b=0;b<a.length;b+=2)c.push({x:a[b],
y:a[b+1]});return c},_getImage:function(a,c){var b,d,l,k;a?this._isElement(a)?c(a):this._isString(a)?(b=new Image,b.onload=function(){c(b)},b.src=a):a.data?(d=document.createElement("canvas"),d.width=a.width,d.height=a.height,l=d.getContext("2d"),l.putImageData(a,0,0),k=d.toDataURL(),b=new Image,b.onload=function(){c(b)},b.src=k):c(null):c(null)},_rgbToHex:function(a,c,b){return(16777216+(a<<16)+(c<<8)+b).toString(16).slice(1)},_hexToRgb:function(a){a=a.replace("#","");a=parseInt(a,16);return{r:a>>
16&255,g:a>>8&255,b:a&255}},getRandomColor:function(){for(var a=(16777215*Math.random()<<0).toString(16);6>a.length;)a="0"+a;return"#"+a},getRGB:function(a){var b;return a in c?(b=c[a],{r:b[0],g:b[1],b:b[2]}):"#"===a[0]?this._hexToRgb(a.substring(1)):"rgb("===a.substr(0,4)?(b=d.exec(a.replace(/ /g,"")),{r:parseInt(b[1]),g:parseInt(b[2]),b:parseInt(b[3])}):{r:0,g:0,b:0}},_merge:function(a,c){var b=this._clone(c),d;for(d in a)this._isObject(a[d])?b[d]=this._merge(a[d],b[d]):b[d]=a[d];return b},_clone:function(a){var c=
{},b;for(b in a)this._isObject(a[b])?c[b]=this._clone(a[b]):c[b]=a[b];return c},_degToRad:function(c){return c*a},_radToDeg:function(a){return a*b},_capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},warn:function(a){window.console&&console.warn&&console.warn("Kinetic warning: "+a)},extend:function(a,c){for(var b in c.prototype)b in a.prototype||(a.prototype[b]=c.prototype[b])},addMethods:function(a,c){for(var b in c)a.prototype[b]=c[b]}}})();
(function(){var a=document.createElement("canvas").getContext("2d"),b=(window.devicePixelRatio||1)/(a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1);Kinetic.Canvas=function(a){this.init(a)};Kinetic.Canvas.prototype={init:function(a){a=a||{};var d=a.width||0,e=a.height||0,f=a.contextType||"2d";this.pixelRatio=a.pixelRatio||b;this.element=document.createElement("canvas");this.element.style.padding=0;this.element.style.margin=
0;this.element.style.border=0;this.element.style.background="transparent";this.context=this.element.getContext(f);this.setSize(d,e)},getElement:function(){return this.element},getContext:function(){return this.context},setWidth:function(a){this.width=this.element.width=a*this.pixelRatio;this.element.style.width=a+"px"},setHeight:function(a){this.height=this.element.height=a*this.pixelRatio;this.element.style.height=a+"px"},getWidth:function(){return this.width},getHeight:function(){return this.height},
setSize:function(a,b){this.setWidth(a);this.setHeight(b)},clear:function(){var a=this.getContext();this.getElement();a.clearRect(0,0,this.getWidth(),this.getHeight())},toDataURL:function(a,b){try{return this.element.toDataURL(a,b)}catch(e){try{return this.element.toDataURL()}catch(f){return Kinetic.Util.warn("Unable to get data URL. "+f.message),""}}},fill:function(a){a.getFillEnabled()&&this._fill(a)},stroke:function(a){a.getStrokeEnabled()&&this._stroke(a)},fillStroke:function(a){var b=a.getFillEnabled();
b&&this._fill(a);a.getStrokeEnabled()&&this._stroke(a,a.hasShadow()&&a.hasFill()&&b)},applyShadow:function(a,b){var e=this.context;e.save();this._applyShadow(a);b();e.restore();b()},_applyLineCap:function(a){(a=a.getLineCap())&&(this.context.lineCap=a)},_applyOpacity:function(a){a=a.getAbsoluteOpacity();1!==a&&(this.context.globalAlpha=a)},_applyLineJoin:function(a){(a=a.getLineJoin())&&(this.context.lineJoin=a)},_applyAncestorTransforms:function(a){var b=this.context,e,f;a._eachAncestorReverse(function(a){e=
a.getTransform(!0);f=e.getMatrix();b.transform(f[0],f[1],f[2],f[3],f[4],f[5])},!0)},_clip:function(a){var b=this.getContext();b.save();this._applyAncestorTransforms(a);b.beginPath();a.getClipFunc()(this);b.clip();b.setTransform(1,0,0,1,0,0)}};Kinetic.SceneCanvas=function(a){Kinetic.Canvas.call(this,a)};Kinetic.SceneCanvas.prototype={setWidth:function(a){var b=this.pixelRatio;Kinetic.Canvas.prototype.setWidth.call(this,a);this.context.scale(b,b)},setHeight:function(a){var b=this.pixelRatio;Kinetic.Canvas.prototype.setHeight.call(this,
a);this.context.scale(b,b)},_fillColor:function(a){var b=this.context,e=a.getFill();b.fillStyle=e;a._fillFunc(b)},_fillPattern:function(a){var b=this.context,e=a.getFillPatternImage(),f=a.getFillPatternX(),g=a.getFillPatternY(),h=a.getFillPatternScale(),l=a.getFillPatternRotation(),k=a.getFillPatternOffset();a=a.getFillPatternRepeat();(f||g)&&b.translate(f||0,g||0);l&&b.rotate(l);h&&b.scale(h.x,h.y);k&&b.translate(-1*k.x,-1*k.y);b.fillStyle=b.createPattern(e,a||"repeat");b.fill()},_fillLinearGradient:function(a){var b=
this.context,e=a.getFillLinearGradientStartPoint(),f=a.getFillLinearGradientEndPoint();a=a.getFillLinearGradientColorStops();e=b.createLinearGradient(e.x,e.y,f.x,f.y);if(a){for(f=0;f<a.length;f+=2)e.addColorStop(a[f],a[f+1]);b.fillStyle=e;b.fill()}},_fillRadialGradient:function(a){var b=this.context,e=a.getFillRadialGradientStartPoint(),f=a.getFillRadialGradientEndPoint(),g=a.getFillRadialGradientStartRadius(),h=a.getFillRadialGradientEndRadius();a=a.getFillRadialGradientColorStops();e=b.createRadialGradient(e.x,
e.y,g,f.x,f.y,h);for(f=0;f<a.length;f+=2)e.addColorStop(a[f],a[f+1]);b.fillStyle=e;b.fill()},_fill:function(a,b){var e=this.context,f=a.getFill(),g=a.getFillPatternImage(),h=a.getFillLinearGradientColorStops(),l=a.getFillRadialGradientColorStops(),k=a.getFillPriority();e.save();!b&&a.hasShadow()&&this._applyShadow(a);f&&"color"===k?this._fillColor(a):g&&"pattern"===k?this._fillPattern(a):h&&"linear-gradient"===k?this._fillLinearGradient(a):l&&"radial-gradient"===k?this._fillRadialGradient(a):f?this._fillColor(a):
g?this._fillPattern(a):h?this._fillLinearGradient(a):l&&this._fillRadialGradient(a);e.restore();!b&&a.hasShadow()&&this._fill(a,!0)},_stroke:function(a,b){var e=this.context,f=a.getStroke(),g=a.getStrokeWidth(),h=a.getDashArray();if(f||g)e.save(),a.getStrokeScaleEnabled()||e.setTransform(1,0,0,1,0,0),this._applyLineCap(a),h&&a.getDashArrayEnabled()&&(e.setLineDash?e.setLineDash(h):"mozDash"in e?e.mozDash=h:"webkitLineDash"in e&&(e.webkitLineDash=h)),!b&&a.hasShadow()&&this._applyShadow(a),e.lineWidth=
g||2,e.strokeStyle=f||"black",a._strokeFunc(e),e.restore(),!b&&a.hasShadow()&&this._stroke(a,!0)},_applyShadow:function(a){var b=this.context;if(a.hasShadow()&&a.getShadowEnabled()){var e=a.getAbsoluteOpacity(),f=a.getShadowColor()||"black",g=a.getShadowBlur()||5,h=a.getShadowOffset()||{x:0,y:0};a.getShadowOpacity()&&(b.globalAlpha=a.getShadowOpacity()*e);b.shadowColor=f;b.shadowBlur=g;b.shadowOffsetX=h.x;b.shadowOffsetY=h.y}}};Kinetic.Util.extend(Kinetic.SceneCanvas,Kinetic.Canvas);Kinetic.HitCanvas=
function(a){Kinetic.Canvas.call(this,a)};Kinetic.HitCanvas.prototype={_fill:function(a){var b=this.context;b.save();b.fillStyle=a.colorKey;a._fillFuncHit(b);b.restore()},_stroke:function(a){var b=this.context,e=a.getStroke(),f=a.getStrokeWidth();if(e||f)this._applyLineCap(a),b.save(),b.lineWidth=f||2,b.strokeStyle=a.colorKey,a._strokeFuncHit(b),b.restore()}};Kinetic.Util.extend(Kinetic.HitCanvas,Kinetic.Canvas)})();
(function(){var a="Shape";Kinetic.Util.addMethods(Kinetic.Node,{_nodeInit:function(a){this._id=Kinetic.Global.idCounter++;this.eventListeners={};this.setAttrs(a)},on:function(a,c){var d=a.split(" "),e=d.length,f,g,h;for(f=0;f<e;f++)g=d[f],h=g.split("."),g=h[0],h=1<h.length?h[1]:"",this.eventListeners[g]||(this.eventListeners[g]=[]),this.eventListeners[g].push({name:h,handler:c});return this},off:function(a){a=a.split(" ");var c=a.length,d,e,f,g;for(d=0;d<c;d++)if(f=e=a[d],f=f.split("."),g=f[0],1<
f.length)if(g)this.eventListeners[g]&&this._off(g,f[1]);else for(e in this.eventListeners)this._off(e,f[1]);else delete this.eventListeners[g];return this},remove:function(){var a=this.getParent();a&&a.children&&(a.children.splice(this.index,1),a._setChildrenIndices());delete this.parent},destroy:function(){this.getParent();this.getStage();for(var a=Kinetic.Global;this.children&&0<this.children.length;)this.children[0].destroy();a._removeId(this.getId());a._removeName(this.getName(),this._id);this.remove()},
getAttr:function(a){var c="get"+Kinetic.Util._capitalize(a);return Kinetic.Util._isFunction(this[c])?this[c]():this.attrs[a]},setAttr:function(){var a=Array.prototype.slice.call(arguments),c=a[0],d=this["set"+Kinetic.Util._capitalize(c)];a.shift();Kinetic.Util._isFunction(d)?d.apply(this,a):this.attrs[c]=a[0]},getAttrs:function(){return this.attrs||{}},createAttrs:function(){void 0===this.attrs&&(this.attrs={})},setAttrs:function(a){var c,d;if(a)for(c in a)"children"!==c&&(d="set"+Kinetic.Util._capitalize(c),
Kinetic.Util._isFunction(this[d])?this[d](a[c]):this._setAttr(c,a[c]))},getVisible:function(){var a=this.attrs.visible,c=this.getParent();return void 0===a&&(a=!0),a&&c&&!c.getVisible()?!1:a},getListening:function(){var a=this.attrs.listening,c=this.getParent();return void 0===a&&(a=!0),a&&c&&!c.getListening()?!1:a},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},getZIndex:function(){return this.index||0},getAbsoluteZIndex:function(){function b(k){f=[];g=k.length;for(h=0;h<
g;h++)l=k[h],e++,l.nodeType!==a&&(f=f.concat(l.getChildren().toArray())),l._id===d._id&&(h=g);0<f.length&&f[0].getLevel()<=c&&b(f)}var c=this.getLevel();this.getStage();var d=this,e=0,f,g,h,l;return"Stage"!==d.nodeType&&b(d.getStage().getChildren()),e},getLevel:function(){for(var a=0,c=this.parent;c;)a++,c=c.parent;return a},setPosition:function(){var a=Kinetic.Util._getXY([].slice.call(arguments));this.setX(a.x);this.setY(a.y)},getPosition:function(){return{x:this.getX(),y:this.getY()}},getAbsolutePosition:function(){var a=
this.getAbsoluteTransform(),c=this.getOffset();return a.translate(c.x,c.y),a.getTranslation()},setAbsolutePosition:function(){var a=Kinetic.Util._getXY([].slice.call(arguments)),c=this._clearTransform(),d;this.attrs.x=c.x;this.attrs.y=c.y;delete c.x;delete c.y;d=this.getAbsoluteTransform();d.invert();d.translate(a.x,a.y);a={x:this.attrs.x+d.getTranslation().x,y:this.attrs.y+d.getTranslation().y};this.setPosition(a.x,a.y);this._setTransform(c)},move:function(){var a=Kinetic.Util._getXY([].slice.call(arguments)),
c=this.getX(),d=this.getY();void 0!==a.x&&(c+=a.x);void 0!==a.y&&(d+=a.y);this.setPosition(c,d)},_eachAncestorReverse:function(a,c){var d=[],e=this.getParent(),f;for(c&&d.unshift(this);e;)d.unshift(e),e=e.parent;e=d.length;for(f=0;f<e;f++)a(d[f])},rotate:function(a){this.setRotation(this.getRotation()+a)},rotateDeg:function(a){this.setRotation(this.getRotation()+Kinetic.Util._degToRad(a))},moveToTop:function(){return this.parent.children.splice(this.index,1),this.parent.children.push(this),this.parent._setChildrenIndices(),
!0},moveUp:function(){var a=this.index,c=this.parent.getChildren().length;if(a<c-1)return this.parent.children.splice(a,1),this.parent.children.splice(a+1,0,this),this.parent._setChildrenIndices(),!0},moveDown:function(){var a=this.index;if(0<a)return this.parent.children.splice(a,1),this.parent.children.splice(a-1,0,this),this.parent._setChildrenIndices(),!0},moveToBottom:function(){var a=this.index;if(0<a)return this.parent.children.splice(a,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),
!0},setZIndex:function(a){this.parent.children.splice(this.index,1);this.parent.children.splice(a,0,this);this.parent._setChildrenIndices()},getAbsoluteOpacity:function(){var a=this.getOpacity();return this.getParent()&&(a*=this.getParent().getAbsoluteOpacity()),a},moveTo:function(a){Kinetic.Node.prototype.remove.call(this);a.add(this)},toObject:function(){var a=Kinetic.Util,c={},d=this.getAttrs(),e,f;c.attrs={};for(e in d)f=d[e],a._isFunction(f)||a._isElement(f)||a._isObject(f)&&a._hasMethods(f)||
(c.attrs[e]=f);return c.className=this.getClassName(),c},toJSON:function(){return JSON.stringify(this.toObject())},getParent:function(){return this.parent},getLayer:function(){return this.getParent().getLayer()},getStage:function(){return this.getParent()?this.getParent().getStage():void 0},fire:function(a,c,d){d?this._fireAndBubble(a,c||{}):this._fire(a,c||{})},getAbsoluteTransform:function(){var a=new Kinetic.Transform,c;return this._eachAncestorReverse(function(d){c=d.getTransform();a.multiply(c)},
!0),a},_getAndCacheTransform:function(){var a=new Kinetic.Transform,c=this.getX(),d=this.getY(),e=this.getRotation(),f=this.getScaleX(),g=this.getScaleY(),h=this.getSkewX(),l=this.getSkewY(),k=this.getOffsetX(),n=this.getOffsetY();return(0!==c||0!==d)&&a.translate(c,d),0!==e&&a.rotate(e),(0!==h||0!==l)&&a.skew(h,l),(1!==f||1!==g)&&a.scale(f,g),(0!==k||0!==n)&&a.translate(-1*k,-1*n),this.cachedTransform=a,a},getTransform:function(a){var c=this.cachedTransform;return a&&c?c:this._getAndCacheTransform()},
clone:function(a){var c=this.getClassName(),c=new Kinetic[c](this.attrs),d,e,f,g,h;for(d in this.eventListeners)for(e=this.eventListeners[d],f=e.length,g=0;g<f;g++)h=e[g],0>h.name.indexOf("kinetic")&&(c.eventListeners[d]||(c.eventListeners[d]=[]),c.eventListeners[d].push(h));return c.setAttrs(a),c},toDataURL:function(a){a=a||{};var c=a.mimeType||null,d=a.quality||null,e=this.getStage(),f=a.x||0,g=a.y||0;a=new Kinetic.SceneCanvas({width:a.width||e.getWidth(),height:a.height||e.getHeight(),pixelRatio:1});
e=a.getContext();return e.save(),(f||g)&&e.translate(-1*f,-1*g),this.drawScene(a),e.restore(),a.toDataURL(c,d)},toImage:function(a){Kinetic.Util._getImage(this.toDataURL(a),function(c){a.callback(c)})},setSize:function(){var a=Kinetic.Util._getSize(Array.prototype.slice.call(arguments));this.setWidth(a.width);this.setHeight(a.height)},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getWidth:function(){return this.attrs.width||0},getHeight:function(){return this.attrs.height||
0},getClassName:function(){return this.className||this.nodeType},getType:function(){return this.nodeType},_get:function(a){return this.nodeType===a?[this]:[]},_off:function(a,c){var d=this.eventListeners[a],e;for(e=0;e<d.length;e++)if(d[e].name===c){d.splice(e,1);if(0===d.length){delete this.eventListeners[a];break}e--}},_clearTransform:function(){var a={x:this.getX(),y:this.getY(),rotation:this.getRotation(),scaleX:this.getScaleX(),scaleY:this.getScaleY(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),
skewX:this.getSkewX(),skewY:this.getSkewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,a},_setTransform:function(a){for(var c in a)this.attrs[c]=a[c];this.cachedTransform=null},_fireBeforeChangeEvent:function(a,c,d){this._fire("before"+Kinetic.Util._capitalize(a)+"Change",{oldVal:c,newVal:d})},_fireChangeEvent:function(a,c,d){this._fire(a+"Change",{oldVal:c,newVal:d})},
setId:function(a){var c=this.getId();this.getStage();var d=Kinetic.Global;d._removeId(c);d._addId(this,a);this._setAttr("id",a)},setName:function(a){var c=this.getName();this.getStage();var d=Kinetic.Global;d._removeName(c,this._id);d._addName(this,a);this._setAttr("name",a)},_setAttr:function(a,c){var d;void 0!==c&&(d=this.attrs[a],this._fireBeforeChangeEvent(a,d,c),this.attrs[a]=c,this._fireChangeEvent(a,d,c))},_fireAndBubble:function(b,c,d){c&&this.nodeType===a&&(c.targetNode=this);this.getStage();
var e=!0;"mouseenter"===b&&d&&this._id===d._id?e=!1:"mouseleave"===b&&d&&this._id===d._id&&(e=!1);e&&(this._fire(b,c),c&&!c.cancelBubble&&this.parent&&(d&&d.parent?this._fireAndBubble.call(this.parent,b,c,d.parent):this._fireAndBubble.call(this.parent,b,c)))},_fire:function(a,c){var d=this.eventListeners[a],e,f;if(d)for(e=d.length,f=0;f<e;f++)d[f].handler.call(this,c)},draw:function(){var a={node:this};this._fire("beforeDraw",a);this.drawScene();this.drawHit();this._fire("draw",a)},shouldDrawHit:function(){return this.isVisible()&&
this.isListening()&&!Kinetic.Global.isDragging()},isDraggable:function(){return!1}});Kinetic.Node.addGetterSetter=function(a,c,d,e){this.addGetter(a,c,d);this.addSetter(a,c,e)};Kinetic.Node.addPointGetterSetter=function(a,c,d,e){this.addPointGetter(a,c);this.addPointSetter(a,c);this.addGetter(a,c+"X",d);this.addGetter(a,c+"Y",d);this.addSetter(a,c+"X",e);this.addSetter(a,c+"Y",e)};Kinetic.Node.addRotationGetterSetter=function(a,c,d,e){this.addRotationGetter(a,c,d);this.addRotationSetter(a,c,e)};Kinetic.Node.addColorGetterSetter=
function(a,c){this.addGetter(a,c);this.addSetter(a,c);this.addColorRGBGetter(a,c);this.addColorComponentGetter(a,c,"r");this.addColorComponentGetter(a,c,"g");this.addColorComponentGetter(a,c,"b");this.addColorRGBSetter(a,c);this.addColorComponentSetter(a,c,"r");this.addColorComponentSetter(a,c,"g");this.addColorComponentSetter(a,c,"b")};Kinetic.Node.addColorRGBGetter=function(a,c){var d="get"+Kinetic.Util._capitalize(c)+"RGB";a.prototype[d]=function(){return Kinetic.Util.getRGB(this.attrs[c])}};Kinetic.Node.addColorRGBSetter=
function(a,c){var d="set"+Kinetic.Util._capitalize(c)+"RGB";a.prototype[d]=function(a){var b=a&&void 0!==a.r?a.r|0:this.getAttr(c+"R"),d=a&&void 0!==a.g?a.g|0:this.getAttr(c+"G");a=a&&void 0!==a.b?a.b|0:this.getAttr(c+"B");this._setAttr(c,"#"+Kinetic.Util._rgbToHex(b,d,a))}};Kinetic.Node.addColorComponentGetter=function(a,c,d){var e="get"+Kinetic.Util._capitalize(c);c=e+Kinetic.Util._capitalize(d);a.prototype[c]=function(){return this[e+"RGB"]()[d]}};Kinetic.Node.addColorComponentSetter=function(a,
c,d){var e="set"+Kinetic.Util._capitalize(c);c=e+Kinetic.Util._capitalize(d);a.prototype[c]=function(a){var c={};c[d]=a;this[e+"RGB"](c)}};Kinetic.Node.addSetter=function(a,c,d){var e="set"+Kinetic.Util._capitalize(c);a.prototype[e]=function(a){this._setAttr(c,a);d&&(this.cachedTransform=null)}};Kinetic.Node.addPointSetter=function(a,c){var d="set"+Kinetic.Util._capitalize(c);a.prototype[d]=function(){var a=Kinetic.Util._getXY([].slice.call(arguments)),b=this.attrs[c],g=0,h=0;a&&(g=a.x,h=a.y,this._fireBeforeChangeEvent(c,
b,a),void 0!==g&&this[d+"X"](g),void 0!==h&&this[d+"Y"](h),this._fireChangeEvent(c,b,a))}};Kinetic.Node.addRotationSetter=function(a,c,d){var e="set"+Kinetic.Util._capitalize(c);a.prototype[e]=function(a){this._setAttr(c,a);d&&(this.cachedTransform=null)};a.prototype[e+"Deg"]=function(a){this._setAttr(c,Kinetic.Util._degToRad(a));d&&(this.cachedTransform=null)}};Kinetic.Node.addGetter=function(a,c,d){var e="get"+Kinetic.Util._capitalize(c);a.prototype[e]=function(a){a=this.attrs[c];return void 0===
a&&(a=d),a}};Kinetic.Node.addPointGetter=function(a,c){var d="get"+Kinetic.Util._capitalize(c);a.prototype[d]=function(a){return{x:this[d+"X"](),y:this[d+"Y"]()}}};Kinetic.Node.addRotationGetter=function(a,c,d){var e="get"+Kinetic.Util._capitalize(c);a.prototype[e]=function(){var a=this.attrs[c];return void 0===a&&(a=d),a};a.prototype[e+"Deg"]=function(){var a=this.attrs[c];return void 0===a&&(a=d),Kinetic.Util._radToDeg(a)}};Kinetic.Node.create=function(a,c){return this._createNode(JSON.parse(a),
c)};Kinetic.Node._createNode=function(a,c){var d=Kinetic.Node.prototype.getClassName.call(a),e=a.children,f,g;c&&(a.attrs.container=c);d=new Kinetic[d](a.attrs);if(e)for(f=e.length,g=0;g<f;g++)d.add(this._createNode(e[g]));return d};Kinetic.Node.addGetterSetter(Kinetic.Node,"x",0,!0);Kinetic.Node.addGetterSetter(Kinetic.Node,"y",0,!0);Kinetic.Node.addGetterSetter(Kinetic.Node,"opacity",1);Kinetic.Node.addGetter(Kinetic.Node,"name");Kinetic.Node.addGetter(Kinetic.Node,"id");Kinetic.Node.addRotationGetterSetter(Kinetic.Node,
"rotation",0,!0);Kinetic.Node.addPointGetterSetter(Kinetic.Node,"scale",1,!0);Kinetic.Node.addPointGetterSetter(Kinetic.Node,"skew",0,!0);Kinetic.Node.addPointGetterSetter(Kinetic.Node,"offset",0,!0);Kinetic.Node.addSetter(Kinetic.Node,"width");Kinetic.Node.addSetter(Kinetic.Node,"height");Kinetic.Node.addSetter(Kinetic.Node,"listening");Kinetic.Node.addSetter(Kinetic.Node,"visible");Kinetic.Node.prototype.isListening=Kinetic.Node.prototype.getListening;Kinetic.Node.prototype.isVisible=Kinetic.Node.prototype.getVisible;
Kinetic.Collection.mapMethods(["on","off","draw"])})();
(function(){Kinetic.Util.addMethods(Kinetic.Container,{_containerInit:function(a){this.children=new Kinetic.Collection;Kinetic.Node.call(this,a)},getChildren:function(){return this.children},removeChildren:function(){for(;0<this.children.length;)this.children[0].remove()},add:function(a){var b=this.children;return a.index=b.length,a.parent=this,b.push(a),this._fire("add",{child:a}),this},get:function(a){var b=new Kinetic.Collection;if("#"===a.charAt(0))(a=this._getNodeById(a.slice(1)))&&b.push(a);
else if("."===a.charAt(0))a=this._getNodesByName(a.slice(1)),Kinetic.Collection.apply(b,a);else{for(var c=[],d=this.getChildren(),e=d.length,f=0;f<e;f++)c=c.concat(d[f]._get(a));Kinetic.Collection.apply(b,c)}return b},_getNodeById:function(a){this.getStage();a=Kinetic.Global.ids[a];return void 0!==a&&this.isAncestorOf(a)?a:null},_getNodesByName:function(a){return this._getDescendants(Kinetic.Global.names[a]||[])},_get:function(a){for(var b=Kinetic.Node.prototype._get.call(this,a),c=this.getChildren(),
d=c.length,e=0;e<d;e++)b=b.concat(c[e]._get(a));return b},toObject:function(){var a=Kinetic.Node.prototype.toObject.call(this);a.children=[];for(var b=this.getChildren(),c=b.length,d=0;d<c;d++)a.children.push(b[d].toObject());return a},_getDescendants:function(a){for(var b=[],c=a.length,d=0;d<c;d++){var e=a[d];this.isAncestorOf(e)&&b.push(e)}return b},isAncestorOf:function(a){for(a=a.getParent();a;){if(a._id===this._id)return!0;a=a.getParent()}return!1},clone:function(a){var b=Kinetic.Node.prototype.clone.call(this,
a);return this.getChildren().each(function(a){b.add(a.clone())}),b},getAllIntersections:function(){for(var a=Kinetic.Util._getXY(Array.prototype.slice.call(arguments)),b=[],c=this.get("Shape"),d=c.length,e=0;e<d;e++){var f=c[e];f.isVisible()&&f.intersects(a)&&b.push(f)}return b},_setChildrenIndices:function(){for(var a=this.children,b=a.length,c=0;c<b;c++)a[c].index=c},drawScene:function(a){var b=this.getLayer(),c=!!this.getClipFunc(),d,e;!a&&b&&(a=b.getCanvas());if(this.isVisible()){c&&a._clip(this);
b=this.children;e=b.length;for(d=0;d<e;d++)b[d].drawScene(a);c&&a.getContext().restore()}},drawHit:function(){var a=!!this.getClipFunc()&&"Stage"!==this.nodeType,b=0,c=0,d=[],e;if(this.shouldDrawHit()){a&&(e=this.getLayer().hitCanvas,e._clip(this));d=this.children;c=d.length;for(b=0;b<c;b++)d[b].drawHit();a&&e.getContext().restore()}}});Kinetic.Util.extend(Kinetic.Container,Kinetic.Node);Kinetic.Node.addGetterSetter(Kinetic.Container,"clipFunc")})();
(function(){function a(a){a.fill()}function b(a){a.stroke()}function c(a){a.fill()}function d(a){a.stroke()}Kinetic.Util.addMethods(Kinetic.Shape,{_initShape:function(e){this.nodeType="Shape";this._fillFunc=a;this._strokeFunc=b;this._fillFuncHit=c;this._strokeFuncHit=d;for(var f=Kinetic.Global.shapes,g;!(g=Kinetic.Util.getRandomColor())||g in f;);this.colorKey=g;f[g]=this;this.createAttrs();Kinetic.Node.call(this,e)},getContext:function(){return this.getLayer().getContext()},getCanvas:function(){return this.getLayer().getCanvas()},
hasShadow:function(){return!!(this.getShadowColor()||this.getShadowBlur()||this.getShadowOffsetX()||this.getShadowOffsetY())},hasFill:function(){return!!(this.getFill()||this.getFillPatternImage()||this.getFillLinearGradientColorStops()||this.getFillRadialGradientColorStops())},_get:function(a){return this.className===a||this.nodeType===a?[this]:[]},intersects:function(){var a=Kinetic.Util._getXY(Array.prototype.slice.call(arguments)),c=this.getStage().hitCanvas;c.clear();this.drawScene(c);return 0<
c.context.getImageData(a.x|0,a.y|0,1,1).data[3]},enableFill:function(){this._setAttr("fillEnabled",!0)},disableFill:function(){this._setAttr("fillEnabled",!1)},enableStroke:function(){this._setAttr("strokeEnabled",!0)},disableStroke:function(){this._setAttr("strokeEnabled",!1)},enableStrokeScale:function(){this._setAttr("strokeScaleEnabled",!0)},disableStrokeScale:function(){this._setAttr("strokeScaleEnabled",!1)},enableShadow:function(){this._setAttr("shadowEnabled",!0)},disableShadow:function(){this._setAttr("shadowEnabled",
!1)},enableDashArray:function(){this._setAttr("dashArrayEnabled",!0)},disableDashArray:function(){this._setAttr("dashArrayEnabled",!1)},destroy:function(){Kinetic.Node.prototype.destroy.call(this);delete Kinetic.Global.shapes[this.colorKey]},drawScene:function(a){var c=this.getDrawFunc();a=a||this.getLayer().getCanvas();var b=a.getContext();c&&this.isVisible()&&(b.save(),a._applyOpacity(this),a._applyLineJoin(this),a._applyAncestorTransforms(this),c.call(this,a),b.restore())},drawHit:function(){var a=
this.getAttrs(),a=a.drawHitFunc||a.drawFunc,c=this.getLayer().hitCanvas,b=c.getContext();a&&this.shouldDrawHit()&&(b.save(),c._applyLineJoin(this),c._applyAncestorTransforms(this),a.call(this,c),b.restore())},_setDrawFuncs:function(){!this.attrs.drawFunc&&this.drawFunc&&this.setDrawFunc(this.drawFunc);!this.attrs.drawHitFunc&&this.drawHitFunc&&this.setDrawHitFunc(this.drawHitFunc)}});Kinetic.Util.extend(Kinetic.Shape,Kinetic.Node);Kinetic.Node.addColorGetterSetter(Kinetic.Shape,"stroke");Kinetic.Node.addGetterSetter(Kinetic.Shape,
"lineJoin");Kinetic.Node.addGetterSetter(Kinetic.Shape,"lineCap");Kinetic.Node.addGetterSetter(Kinetic.Shape,"strokeWidth");Kinetic.Node.addGetterSetter(Kinetic.Shape,"drawFunc");Kinetic.Node.addGetterSetter(Kinetic.Shape,"drawHitFunc");Kinetic.Node.addGetterSetter(Kinetic.Shape,"dashArray");Kinetic.Node.addColorGetterSetter(Kinetic.Shape,"shadowColor");Kinetic.Node.addGetterSetter(Kinetic.Shape,"shadowBlur");Kinetic.Node.addGetterSetter(Kinetic.Shape,"shadowOpacity");Kinetic.Node.addGetterSetter(Kinetic.Shape,
"fillPatternImage");Kinetic.Node.addColorGetterSetter(Kinetic.Shape,"fill");Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillPatternX");Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillPatternY");Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillLinearGradientColorStops");Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillRadialGradientStartRadius");Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillRadialGradientEndRadius");Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillRadialGradientColorStops");Kinetic.Node.addGetterSetter(Kinetic.Shape,
"fillPatternRepeat");Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillEnabled",!0);Kinetic.Node.addGetterSetter(Kinetic.Shape,"strokeEnabled",!0);Kinetic.Node.addGetterSetter(Kinetic.Shape,"shadowEnabled",!0);Kinetic.Node.addGetterSetter(Kinetic.Shape,"dashArrayEnabled",!0);Kinetic.Node.addGetterSetter(Kinetic.Shape,"fillPriority","color");Kinetic.Node.addGetterSetter(Kinetic.Shape,"strokeScaleEnabled",!0);Kinetic.Node.addPointGetterSetter(Kinetic.Shape,"fillPatternOffset",0);Kinetic.Node.addPointGetterSetter(Kinetic.Shape,
"fillPatternScale",1);Kinetic.Node.addPointGetterSetter(Kinetic.Shape,"fillLinearGradientStartPoint",0);Kinetic.Node.addPointGetterSetter(Kinetic.Shape,"fillLinearGradientEndPoint",0);Kinetic.Node.addPointGetterSetter(Kinetic.Shape,"fillRadialGradientStartPoint",0);Kinetic.Node.addPointGetterSetter(Kinetic.Shape,"fillRadialGradientEndPoint",0);Kinetic.Node.addPointGetterSetter(Kinetic.Shape,"shadowOffset",0);Kinetic.Node.addRotationGetterSetter(Kinetic.Shape,"fillPatternRotation",0)})();
(function(){function a(a,b){a.content.addEventListener(b,function(e){e.preventDefault();a[UNDERSCORE+b](e)},!1)}var b="mouseout",b="mouseout";TOUCHEND="touchend";TAP="tap";DBL_TAP="dbltap";TOUCHMOVE="touchmove";DIV="div";RELATIVE="relative";INLINE_BLOCK="inline-block";KINETICJS_CONTENT="kineticjs-content";SPACE=" ";UNDERSCORE="_";CONTAINER="container";EVENTS=["mousedown","mousemove","mouseup",b,"touchstart",TOUCHMOVE,TOUCHEND];eventsLength=EVENTS.length;Kinetic.Util.addMethods(Kinetic.Stage,{_initStage:function(a){this.createAttrs();
Kinetic.Container.call(this,a);this.nodeType="Stage";this.dblClickWindow=400;this._id=Kinetic.Global.idCounter++;this._buildDOM();this._bindContentEvents();Kinetic.Global.stages.push(this)},setContainer:function(a){"string"===typeof a&&(a=document.getElementById(a));this._setAttr(CONTAINER,a)},draw:function(){var a=this.getChildren(),b=a.length,e,f;for(e=0;e<b;e++)f=a[e],f.getClearBeforeDraw()&&(f.getCanvas().clear(),f.getHitCanvas().clear());Kinetic.Node.prototype.draw.call(this)},setHeight:function(a){Kinetic.Node.prototype.setHeight.call(this,
a);this._resizeDOM()},setWidth:function(a){Kinetic.Node.prototype.setWidth.call(this,a);this._resizeDOM()},clear:function(){var a=this.children,b=a.length,e;for(e=0;e<b;e++)a[e].clear()},remove:function(){var a=this.content;Kinetic.Node.prototype.remove.call(this);a&&Kinetic.Util._isInDocument(a)&&this.getContainer().removeChild(a)},getMousePosition:function(){return this.mousePos},getTouchPosition:function(){return this.touchPos},getPointerPosition:function(){return this.getTouchPosition()||this.getMousePosition()},
getStage:function(){return this},getContent:function(){return this.content},toDataURL:function(a){function b(g){var h=n[g].toDataURL(),m=new Image;m.onload=function(){k.drawImage(m,0,0);g<n.length-1?b(g+1):a.callback(l.toDataURL(e,f))};m.src=h}a=a||{};var e=a.mimeType||null,f=a.quality||null,g=a.x||0,h=a.y||0,l=new Kinetic.SceneCanvas({width:a.width||this.getWidth(),height:a.height||this.getHeight(),pixelRatio:1}),k=l.getContext(),n=this.children;(g||h)&&k.translate(-1*g,-1*h);b(0)},toImage:function(a){var b=
a.callback;a.callback=function(a){Kinetic.Util._getImage(a,function(a){b(a)})};this.toDataURL(a)},getIntersection:function(){var a=Kinetic.Util._getXY(Array.prototype.slice.call(arguments)),b=this.getChildren(),e,f;for(e=b.length-1;0<=e;e--)if(f=b[e].getIntersection(a))return f;return null},_resizeDOM:function(){if(this.content){var a=this.getWidth(),b=this.getHeight(),e=this.getChildren(),f=e.length,g;this.content.style.width=a+"px";this.content.style.height=b+"px";this.bufferCanvas.setSize(a,b,
1);this.hitCanvas.setSize(a,b);for(g=0;g<f;g++)layer=e[g],layer.getCanvas().setSize(a,b),layer.hitCanvas.setSize(a,b),layer.draw()}},add:function(a){return Kinetic.Container.prototype.add.call(this,a),a.canvas.setSize(this.attrs.width,this.attrs.height),a.hitCanvas.setSize(this.attrs.width,this.attrs.height),a.draw(),this.content.appendChild(a.canvas.element),this},getParent:function(){return null},getLayer:function(){return null},getLayers:function(){return this.getChildren()},_setPointerPosition:function(a){a||
(a=window.event);this._setMousePosition(a);this._setTouchPosition(a)},_bindContentEvents:function(){var c;for(c=0;c<eventsLength;c++)a(this,EVENTS[c])},_mouseout:function(a){this._setPointerPosition(a);var d=Kinetic.Global,e=this.targetShape;e&&!d.isDragging()&&(e._fireAndBubble(b,a),e._fireAndBubble("mouseleave",a),this.targetShape=null);this.mousePos=void 0},_mousemove:function(a){this._setPointerPosition(a);var d=Kinetic.Global,e=Kinetic.DD,f=this.getIntersection(this.getPointerPosition()),g;f?
(g=f.shape,g&&(d.isDragging()||255!==f.pixel[3]||this.targetShape&&this.targetShape._id===g._id?g._fireAndBubble("mousemove",a):(this.targetShape&&(this.targetShape._fireAndBubble(b,a,g),this.targetShape._fireAndBubble("mouseleave",a,g)),g._fireAndBubble("mouseover",a,this.targetShape),g._fireAndBubble("mouseenter",a,this.targetShape),this.targetShape=g))):this.targetShape&&!d.isDragging()&&(this.targetShape._fireAndBubble(b,a),this.targetShape._fireAndBubble("mouseleave",a),this.targetShape=null);
e&&e._drag(a)},_mousedown:function(a){this._setPointerPosition(a);var b=Kinetic.Global,e=this.getIntersection(this.getPointerPosition()),f;e&&e.shape&&(f=e.shape,this.clickStart=!0,this.clickStartShape=f,f._fireAndBubble("mousedown",a));this.isDraggable()&&!b.isDragReady()&&this.startDrag(a)},_mouseup:function(a){this._setPointerPosition(a);var b=this,e=Kinetic.Global,f=this.getIntersection(this.getPointerPosition()),g;f&&f.shape&&(g=f.shape,g._fireAndBubble("mouseup",a),this.clickStart&&!e.isDragging()&&
g._id===this.clickStartShape._id&&(g._fireAndBubble("click",a),this.inDoubleClickWindow&&g._fireAndBubble("dblclick",a),this.inDoubleClickWindow=!0,setTimeout(function(){b.inDoubleClickWindow=!1},this.dblClickWindow)));this.clickStart=!1},_touchstart:function(a){this._setPointerPosition(a);var b=Kinetic.Global,e=this.getIntersection(this.getPointerPosition()),f;e&&e.shape&&(f=e.shape,this.tapStart=!0,this.tapStartShape=f,f._fireAndBubble("touchstart",a));this.isDraggable()&&!b.isDragReady()&&this.startDrag(a)},
_touchend:function(a){this._setPointerPosition(a);var b=this,e=Kinetic.Global,f=this.getIntersection(this.getPointerPosition()),g;f&&f.shape&&(g=f.shape,g._fireAndBubble(TOUCHEND,a),this.tapStart&&!e.isDragging()&&g._id===this.tapStartShape._id&&(g._fireAndBubble(TAP,a),this.inDoubleClickWindow&&g._fireAndBubble(DBL_TAP,a),this.inDoubleClickWindow=!0,setTimeout(function(){b.inDoubleClickWindow=!1},this.dblClickWindow)));this.tapStart=!1},_touchmove:function(a){this._setPointerPosition(a);var b=Kinetic.DD,
e=this.getIntersection(this.getPointerPosition()),f;e&&e.shape&&(f=e.shape,f._fireAndBubble(TOUCHMOVE,a));b&&b._drag(a)},_setMousePosition:function(a){var b=a.clientX-this._getContentPosition().left;a=a.clientY-this._getContentPosition().top;this.mousePos={x:b,y:a}},_setTouchPosition:function(a){var b,e,f;void 0!==a.touches&&1===a.touches.length&&(b=a.touches[0],e=b.clientX-this._getContentPosition().left,f=b.clientY-this._getContentPosition().top,this.touchPos={x:e,y:f})},_getContentPosition:function(){var a=
this.content.getBoundingClientRect();return{top:a.top,left:a.left}},_buildDOM:function(){this.content=document.createElement(DIV);this.content.style.position=RELATIVE;this.content.style.display=INLINE_BLOCK;this.content.className=KINETICJS_CONTENT;this.attrs.container.appendChild(this.content);this.bufferCanvas=new Kinetic.SceneCanvas;this.hitCanvas=new Kinetic.HitCanvas;this._resizeDOM()},_onContent:function(a,b){var e=a.split(SPACE),f=e.length,g,h;for(g=0;g<f;g++)h=e[g],this.content.addEventListener(h,
b,!1)}});Kinetic.Util.extend(Kinetic.Stage,Kinetic.Container);Kinetic.Node.addGetter(Kinetic.Stage,"container")})();
(function(){Kinetic.Util.addMethods(Kinetic.Layer,{_initLayer:function(a){this.nodeType="Layer";this.createAttrs();this.canvas=new Kinetic.SceneCanvas;this.canvas.getElement().style.position="absolute";this.hitCanvas=new Kinetic.HitCanvas;Kinetic.Container.call(this,a)},getIntersection:function(){var a=Kinetic.Util._getXY(Array.prototype.slice.call(arguments)),b,c;if(this.isVisible()&&this.isListening()){a=this.hitCanvas.context.getImageData(a.x|0,a.y|0,1,1).data;if(255===a[3])return b=Kinetic.Util._rgbToHex(a[0],
a[1],a[2]),c=Kinetic.Global.shapes["#"+b],{shape:c,pixel:a};if(0<a[0]||0<a[1]||0<a[2]||0<a[3])return{pixel:a}}return null},drawScene:function(a){a=a||this.getCanvas();this.getClearBeforeDraw()&&a.clear();Kinetic.Container.prototype.drawScene.call(this,a)},drawHit:function(){var a=this.getLayer();a&&a.getClearBeforeDraw()&&a.getHitCanvas().clear();Kinetic.Container.prototype.drawHit.call(this)},getCanvas:function(){return this.canvas},getHitCanvas:function(){return this.hitCanvas},getContext:function(){return this.getCanvas().getContext()},
clear:function(){this.getCanvas().clear()},setVisible:function(a){Kinetic.Node.prototype.setVisible.call(this,a);a?(this.getCanvas().element.style.display="block",this.hitCanvas.element.style.display="block"):(this.getCanvas().element.style.display="none",this.hitCanvas.element.style.display="none")},setZIndex:function(a){Kinetic.Node.prototype.setZIndex.call(this,a);var b=this.getStage();b&&(b.content.removeChild(this.getCanvas().element),a<b.getChildren().length-1?b.content.insertBefore(this.getCanvas().element,
b.getChildren()[a+1].getCanvas().element):b.content.appendChild(this.getCanvas().element))},moveToTop:function(){Kinetic.Node.prototype.moveToTop.call(this);var a=this.getStage();a&&(a.content.removeChild(this.getCanvas().element),a.content.appendChild(this.getCanvas().element))},moveUp:function(){if(Kinetic.Node.prototype.moveUp.call(this)){var a=this.getStage();a&&(a.content.removeChild(this.getCanvas().element),this.index<a.getChildren().length-1?a.content.insertBefore(this.getCanvas().element,
a.getChildren()[this.index+1].getCanvas().element):a.content.appendChild(this.getCanvas().element))}},moveDown:function(){if(Kinetic.Node.prototype.moveDown.call(this)){var a=this.getStage();if(a){var b=a.getChildren();a.content.removeChild(this.getCanvas().element);a.content.insertBefore(this.getCanvas().element,b[this.index+1].getCanvas().element)}}},moveToBottom:function(){if(Kinetic.Node.prototype.moveToBottom.call(this)){var a=this.getStage();if(a){var b=a.getChildren();a.content.removeChild(this.getCanvas().element);
a.content.insertBefore(this.getCanvas().element,b[1].getCanvas().element)}}},getLayer:function(){return this},remove:function(){var a=this.getStage(),b=this.getCanvas(),c=b.element;Kinetic.Node.prototype.remove.call(this);a&&b&&Kinetic.Util._isInDocument(c)&&a.content.removeChild(c)}});Kinetic.Util.extend(Kinetic.Layer,Kinetic.Container);Kinetic.Node.addGetterSetter(Kinetic.Layer,"clearBeforeDraw",!0)})();
(function(){Kinetic.Util.addMethods(Kinetic.Group,{_initGroup:function(a){this.nodeType="Group";this.createAttrs();Kinetic.Container.call(this,a)}});Kinetic.Util.extend(Kinetic.Group,Kinetic.Container)})();
(function(){Kinetic.Rect=function(a){this._initRect(a)};Kinetic.Rect.prototype={_initRect:function(a){this.createAttrs();Kinetic.Shape.call(this,a);this.className="Rect";this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext(),c=this.getCornerRadius(),d=this.getWidth(),e=this.getHeight();b.beginPath();c?(b.moveTo(c,0),b.lineTo(d-c,0),b.arc(d-c,c,c,3*Math.PI/2,0,!1),b.lineTo(d,e-c),b.arc(d-c,e-c,c,0,Math.PI/2,!1),b.lineTo(c,e),b.arc(c,e-c,c,Math.PI/2,Math.PI,!1),b.lineTo(0,c),b.arc(c,c,c,Math.PI,
3*Math.PI/2,!1)):b.rect(0,0,d,e);b.closePath();a.fillStroke(this)}};Kinetic.Util.extend(Kinetic.Rect,Kinetic.Shape);Kinetic.Node.addGetterSetter(Kinetic.Rect,"cornerRadius",0)})();
(function(){Kinetic.Image=function(a){this._initImage(a)};Kinetic.Image.prototype={_initImage:function(a){Kinetic.Shape.call(this,a);this.className="Image";this._setDrawFuncs()},drawFunc:function(a){var b=this.getWidth(),c=this.getHeight(),d,e=this,f=a.getContext(),g=this.getCrop(),h,l,k,n,p;this.getFilter()&&this._applyFilter&&(this.applyFilter(),this._applyFilter=!1);this.filterCanvas?p=this.filterCanvas.getElement():p=this.getImage();f.beginPath();f.rect(0,0,b,c);f.closePath();a.fillStroke(this);
p&&(g?(h=g.x||0,l=g.y||0,k=g.width||0,n=g.height||0,d=[p,h,l,k,n,0,0,b,c]):d=[p,0,0,b,c],this.hasShadow()?a.applyShadow(this,function(){e._drawImage(f,d)}):this._drawImage(f,d))},drawHitFunc:function(a){var b=this.getWidth(),c=this.getHeight(),d=this.imageHitRegion,e=a.getContext();d?(e.drawImage(d,0,0,b,c),e.beginPath(),e.rect(0,0,b,c),e.closePath(),a.stroke(this)):(e.beginPath(),e.rect(0,0,b,c),e.closePath(),a.fillStroke(this))},applyFilter:function(){var a=this.getImage(),b=this.getWidth(),c=this.getHeight(),
d=this.getFilter(),e,f,g;this.filterCanvas?e=this.filterCanvas:e=this.filterCanvas=new Kinetic.SceneCanvas({width:b,height:c});f=e.getContext();try{this._drawImage(f,[a,0,0,b,c]),g=f.getImageData(0,0,e.getWidth(),e.getHeight()),d.call(this,g),f.putImageData(g,0,0)}catch(h){this.clearFilter(),Kinetic.Util.warn("Unable to apply filter. "+h.message)}},clearFilter:function(){this.filterCanvas=null;this._applyFilter=!1},setCrop:function(){var a=[].slice.call(arguments),b=Kinetic.Util._getXY(a),a=Kinetic.Util._getSize(a),
b=Kinetic.Util._merge(b,a);this._setAttr("crop",Kinetic.Util._merge(b,this.getCrop()))},createImageHitRegion:function(a){var b=this,c=this.getWidth(),d=this.getHeight(),e=(new Kinetic.Canvas({width:c,height:d})).getContext(),f=this.getImage(),g,h,l,k,n;e.drawImage(f,0,0);try{g=e.getImageData(0,0,c,d);h=g.data;l=Kinetic.Util._hexToRgb(this.colorKey);k=0;for(n=h.length;k<n;k+=4)0<h[k+3]&&(h[k]=l.r,h[k+1]=l.g,h[k+2]=l.b);Kinetic.Util._getImage(g,function(c){b.imageHitRegion=c;a&&a()})}catch(p){Kinetic.Util.warn("Unable to create image hit region. "+
p.message)}},clearImageHitRegion:function(){delete this.imageHitRegion},getWidth:function(){var a=this.getImage();return this.attrs.width||(a?a.width:0)},getHeight:function(){var a=this.getImage();return this.attrs.height||(a?a.height:0)},_drawImage:function(a,b){5===b.length?a.drawImage(b[0],b[1],b[2],b[3],b[4]):9===b.length&&a.drawImage(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}};Kinetic.Util.extend(Kinetic.Image,Kinetic.Shape);Kinetic.Node.addFilterGetterSetter=function(a,b,c){this.addGetter(a,
b,c);this.addFilterSetter(a,b)};Kinetic.Node.addFilterSetter=function(a,b){var c="set"+Kinetic.Util._capitalize(b);a.prototype[c]=function(a){this._setAttr(b,a);this._applyFilter=!0}};Kinetic.Node.addGetterSetter(Kinetic.Image,"image");Kinetic.Node.addGetter(Kinetic.Image,"crop");Kinetic.Node.addFilterGetterSetter(Kinetic.Image,"filter")})();
(function(){function a(a){a.fillText(this.partialText,0,0)}function b(a){a.strokeText(this.partialText,0,0)}var c="fontFamily fontSize fontStyle padding align lineHeight text width height wrap".split(" "),d=c.length,e=document.createElement("canvas").getContext("2d");Kinetic.Text=function(a){this._initText(a)};Kinetic.Text.prototype={_initText:function(e){this.createAttrs();this.attrs.width="auto";this.attrs.height="auto";Kinetic.Shape.call(this,e);this._fillFunc=a;this._strokeFunc=b;this.className=
"Text";this._setDrawFuncs();for(e=0;e<d;e++)this.on(c[e]+"Change.kinetic",this._setTextData);this._setTextData()},drawFunc:function(a){var b=a.getContext(),c=this.getPadding();this.getFontStyle();this.getFontSize();this.getFontFamily();var d=this.getTextHeight(),e=this.getLineHeight()*d,n=this.textArr,p=n.length,s=this.getWidth();b.font=this._getContextFont();b.textBaseline="middle";b.textAlign="left";b.save();b.translate(c,0);b.translate(0,c+d/2);for(d=0;d<p;d++){var m=n[d],q=m.text,m=m.width;b.save();
"right"===this.getAlign()?b.translate(s-m-2*c,0):"center"===this.getAlign()&&b.translate((s-m-2*c)/2,0);this.partialText=q;a.fillStroke(this);b.restore();b.translate(0,e)}b.restore()},drawHitFunc:function(a){var b=a.getContext(),c=this.getWidth(),d=this.getHeight();b.beginPath();b.rect(0,0,c,d);b.closePath();a.fillStroke(this)},setText:function(a){a=Kinetic.Util._isString(a)?a:a.toString();this._setAttr("text",a)},getWidth:function(){return"auto"===this.attrs.width?this.getTextWidth()+2*this.getPadding():
this.attrs.width},getHeight:function(){return"auto"===this.attrs.height?this.getTextHeight()*this.textArr.length*this.getLineHeight()+2*this.getPadding():this.attrs.height},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},_getTextSize:function(a){var b=this.getFontSize(),c;return e.save(),e.font=this._getContextFont(),c=e.measureText(a),e.restore(),{width:c.width,height:parseInt(b,10)}},_getContextFont:function(){return this.getFontStyle()+" "+this.getFontSize()+
"px "+this.getFontFamily()},_addTextLine:function(a,b,c){return this.textArr.push({text:a,width:b})},_getTextWidth:function(a){return e.measureText(a).width},_setTextData:function(){var a=this.getText().split("\n"),b=+this.getFontSize(),c=0,d=this.getLineHeight()*b,k=this.attrs.width,n=this.attrs.height,p="auto"!==k,s="auto"!==n,m=this.getPadding(),k=k-2*m,n=n-2*m,m=0,q=this.getWrap(),t="none"!==q,q="char"!==q&&t;this.textArr=[];e.save();e.font=this.getFontStyle()+" "+b+"px "+this.getFontFamily();
for(var x=0,v=a.length;x<v;++x){var u=a[x],r=this._getTextWidth(u);if(p&&r>k)for(;0<u.length;){for(var r=0,w=u.length,y="",z=0;r<w;){var B=r+w>>>1,A=u.slice(0,B+1),C=this._getTextWidth(A);C<=k?(r=B+1,y=A,z=C):w=B}if(!y)break;q&&(w=Math.max(y.lastIndexOf(" "),y.lastIndexOf("-"))+1,0<w&&(r=w,y=y.slice(0,r),z=this._getTextWidth(y)));this._addTextLine(y,z);m+=d;if(!t||s&&m+d>n)break;u=u.slice(r);if(0<u.length&&(r=this._getTextWidth(u),r<=k)){this._addTextLine(u,r);m+=d;break}}else this._addTextLine(u,
r),m+=d,c=Math.max(c,r);if(s&&m+d>n)break}e.restore();this.textHeight=b;this.textWidth=c}};Kinetic.Util.extend(Kinetic.Text,Kinetic.Shape);Kinetic.Node.addGetterSetter(Kinetic.Text,"fontFamily","Calibri");Kinetic.Node.addGetterSetter(Kinetic.Text,"fontSize",12);Kinetic.Node.addGetterSetter(Kinetic.Text,"fontStyle","normal");Kinetic.Node.addGetterSetter(Kinetic.Text,"padding",0);Kinetic.Node.addGetterSetter(Kinetic.Text,"align","left");Kinetic.Node.addGetterSetter(Kinetic.Text,"lineHeight",1);Kinetic.Node.addGetterSetter(Kinetic.Text,
"wrap","word");Kinetic.Node.addGetter(Kinetic.Text,"text","");Kinetic.Node.addSetter(Kinetic.Text,"width");Kinetic.Node.addSetter(Kinetic.Text,"height")})();"use strict";
var TWEEN=TWEEN||function(){var a=[];return{REVISION:"10",getAll:function(){return a},removeAll:function(){a=[]},add:function(b){a.push(b)},remove:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},update:function(b){if(0===a.length)return!1;var c=0,d=a.length;for(b=void 0!==b?b:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();c<d;)a[c].update(b)?c++:(a.splice(c,1),d--);return!0}}}();
TWEEN.Tween=function(a){var b={},c={},d={},e=1E3,f=0,g=0,h=null,l=TWEEN.Easing.Linear.None,k=TWEEN.Interpolation.Linear,n=[],p=null,s=!1,m=null,q=null,t;for(t in a)b[t]=parseFloat(a[t],10);this.to=function(a,b){void 0!==b&&(e=b);c=a;return this};this.start=function(e){TWEEN.add(this);s=!1;h=void 0!==e?e:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();h+=g;for(var f in c){if(c[f]instanceof Array){if(0===c[f].length)continue;c[f]=[a[f]].concat(c[f])}b[f]=
a[f];!1===b[f]instanceof Array&&(b[f]*=1);d[f]=b[f]||0}return this};this.stop=function(){TWEEN.remove(this);return this};this.delay=function(a){g=a;return this};this.repeat=function(a){f=a;return this};this.easing=function(a){l=a;return this};this.interpolation=function(a){k=a;return this};this.chain=function(){n=arguments;return this};this.onStart=function(a){p=a;return this};this.onUpdate=function(a){m=a;return this};this.onComplete=function(a){q=a;return this};this.update=function(x){if(x<h)return!0;
!1===s&&(null!==p&&p.call(a),s=!0);var v=(x-h)/e,v=1<v?1:v,u=l(v),r;for(r in c){var w=b[r]||0,t=c[r];t instanceof Array?a[r]=k(t,u):("string"===typeof t&&(t=w+parseFloat(t,10)),a[r]=w+(t-w)*u)}null!==m&&m.call(a,u);if(1==v)if(0<f){isFinite(f)&&f--;for(r in d)"string"===typeof c[r]&&(d[r]+=parseFloat(c[r],10)),b[r]=d[r];h=x+g}else{null!==q&&q.call(a);v=0;for(u=n.length;v<u;v++)n[v].start(x);return!1}return!0}};
TWEEN.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?0.5*a*a:-0.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a:0.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a:-0.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*
a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*a*a*a:0.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return 0.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?0.5*Math.pow(1024,a-1):0.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-
Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-0.5*(Math.sqrt(1-a*a)-1):0.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var b,c=0.1;if(0===a)return 0;if(1===a)return 1;!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI);return-(c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/0.4))},Out:function(a){var b,c=0.1;if(0===a)return 0;if(1===a)return 1;!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI);return c*Math.pow(2,-10*a)*Math.sin(2*(a-
b)*Math.PI/0.4)+1},InOut:function(a){var b,c=0.1;if(0===a)return 0;if(1===a)return 1;!c||1>c?(c=1,b=0.1):b=0.4*Math.asin(1/c)/(2*Math.PI);return 1>(a*=2)?-0.5*c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/0.4):0.5*c*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/0.4)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?0.5*a*a*(3.5949095*a-2.5949095):0.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-
TWEEN.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},InOut:function(a){return 0.5>a?0.5*TWEEN.Easing.Bounce.In(2*a):0.5*TWEEN.Easing.Bounce.Out(2*a-1)+0.5}}};
TWEEN.Interpolation={Linear:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d),f=TWEEN.Interpolation.Utils.Linear;return 0>b?f(a[0],a[1],d):1<b?f(a[c],a[c-1],c-d):f(a[e],a[e+1>c?c:e+1],d-e)},Bezier:function(a,b){var c=0,d=a.length-1,e=Math.pow,f=TWEEN.Interpolation.Utils.Bernstein,g;for(g=0;g<=d;g++)c+=e(1-b,d-g)*e(b,g)*a[g]*f(d,g);return c},CatmullRom:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d),f=TWEEN.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(e=Math.floor(d=c*(1+b))),f(a[(e-
1+c)%c],a[e],a[(e+1)%c],a[(e+2)%c],d-e)):0>b?a[0]-(f(a[0],a[0],a[1],a[1],-d)-a[0]):1<b?a[c]-(f(a[c],a[c],a[c-1],a[c-1],d-c)-a[c]):f(a[e?e-1:0],a[e],a[c<e+1?c:e+1],a[c<e+2?c:e+2],d-e)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=TWEEN.Interpolation.Utils.Factorial;return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c=1,d;if(a[b])return a[b];for(d=b;1<d;d--)c*=d;return a[b]=c}}(),CatmullRom:function(a,b,c,d,e){a=0.5*(c-a);d=0.5*(d-b);var f=
e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}}};function extend(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a}isNull=function(a){return null===a||"undefined"===typeof a?!0:!1};
function queryString(){var a={},b=window.location.search;0==b.indexOf("?")&&(b=b.substring(1));for(var b=b.split("&"),c=0;c<b.length;c++){var d=b[c].split("=");"undefined"===typeof a[d[0]]?a[d[0]]=d[1]:"string"===typeof a[d[0]]?a[d[0]]=[a[d[0]],d[1]]:a[d[0]].push(d[1])}return a}
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var f=(new Date).getTime(),g=Math.max(0,16-(f-a)),h=window.setTimeout(function(){b(f+g)},g);a=f+g;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();
var APPS_EASE=APPS_EASE||function(){return{Linear:{None:function(a,b,c,d){return b+a/d*c}},Back:{In:function(a,b,c,d){return c*(a/=d)*a*(2.70158*a-1.70158)+b},Out:function(a,b,c,d){return c*((a=a/d-1)*a*(2.70158*a+1.70158)+1)+b},InOut:function(a,b,c,d){var e=1.70158;return 1>(a/=d/2)?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b}},Bounce:{In:function(a,b,c,d){return c-APPS_EASE.Bounce.Out(d-a,0,c,d)+b},Out:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:a<2/2.75?c*(7.5625*
(a-=1.5/2.75)*a+0.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+0.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+0.984375)+b},InOut:function(a,b,c,d){return a<d/2?0.5*APPS_EASE.Bounce.In(2*a,0,c,d)+b:0.5*APPS_EASE.Bounce.Out(2*a-d,0,c,d)+0.5*c+b}},Circular:{In:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},Out:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},InOut:function(a,b,c,d){return 1>(a/=d/2)?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b}},Cubic:{In:function(a,b,c,d){return c*
(a/=d)*a*a+b},Out:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},InOut:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b}},Elastic:{In:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(1==(a/=d))return b+c;f||(f=0.3*d);g<Math.abs(c)?(g=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f))+b},Out:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(1==(a/=d))return b+c;f||(f=0.3*d);g<Math.abs(c)?(g=c,e=f/4):e=f/(2*
Math.PI)*Math.asin(c/g);return g*Math.pow(2,-10*a)*Math.sin(2*(a*d-e)*Math.PI/f)+c+b},InOut:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0==a)return b;if(2==(a/=d/2))return b+c;f||(f=0.3*d*1.5);g<Math.abs(c)?(g=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/g);return 1>a?-0.5*g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)+b:g*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)*0.5+c+b}}}}();
function PEaseHelper(){this.getEasingFunction=function(b){return a[b]};var a={linear:APPS_EASE.Linear.None,backIn:APPS_EASE.Back.In,backOut:APPS_EASE.Back.Out,backInOut:APPS_EASE.Back.InOut,bounceIn:APPS_EASE.Bounce.In,bounceOut:APPS_EASE.Bounce.Out,bounceInOut:APPS_EASE.Bounce.InOut,circIn:APPS_EASE.Circular.In,circOut:APPS_EASE.Circular.Out,circInOut:APPS_EASE.Circular.InOut,cubicIn:APPS_EASE.Cubic.In,cubicOut:APPS_EASE.Cubic.Out,cubicInOut:APPS_EASE.Cubic.InOut,elasticIn:APPS_EASE.Elastic.In,elasticOut:APPS_EASE.Elastic.Out,
elasticInOut:APPS_EASE.Elastic.InOut}}
function PFontHelper(){this._googleFonts={"Droid Sans":"Droid+Sans::latin","Open Sans":"Open+Sans::latin",Oswald:"Oswald::latin","Droid Serif":"Droid+Serif::latin","PT Sans":"PT+Sans::latin","Yanone Kaffeesatz":"Yanone+Kaffeesatz::latin",Lato:"Lato::latin",Arvo:"Arvo::latin",Lora:"Lora::latin","PT Sans Narrow":"PT+Sans+Narrow::latin",Ubuntu:"Ubuntu::latin",Lobster:"Lobster::latin","Open Sans Condensed":"Open+Sans+Condensed:300:latin",Nunito:"Nunito::latin","Source Sans Pro":"Source+Sans+Pro::latin","Crafty Girls":"Crafty+Girls::latin",
Cabin:"Cabin::latin",Arimo:"Arimo::latin","The Girl Next Door":"The+Girl+Next+Door::latin","PT Serif":"PT+Serif::latin","Shadows Into Light":"Shadows+Into+Light::latin",Rokkitt:"Rokkitt::latin","Francois One":"Francois+One::latin",Raleway:"Raleway::latin",Play:"Play::latin",Unkempt:"Unkempt::latin","Josefin Sans":"Josefin+Sans::latin",Bitter:"Bitter::latin",Anton:"Anton::latin","Coming Soon":"Coming+Soon::latin",Cuprum:"Cuprum::latin",Merriweather:"Merriweather::latin","Dancing Script":"Dancing+Script::latin",
Nobile:"Nobile::latin",Vollkorn:"Vollkorn::latin","Changa One":"Changa+One::latin",Questrial:"Questrial::latin",Dosis:"Dosis::latin",Abel:"Abel::latin","Reenie Beanie":"Reenie+Beanie::latin",Calligraffitti:"Calligraffitti::latin",Exo:"Exo::latin",Tangerine:"Tangerine::latin",Cantarell:"Cantarell::latin","Ubuntu Condensed":"Ubuntu+Condensed::latin",Pacifico:"Pacifico::latin",Roboto:"Roboto::latin",Chewy:"Chewy::latin","Roboto Condensed":"Roboto+Condensed::latin",Molengo:"Molengo::latin"};this.fontsToLoad=
[]}PFontHelper.prototype.addFont=function(a){this.fontsToLoad.push(a)};
PFontHelper.prototype.request=function(){for(var a=[],b=0;b<this.fontsToLoad.length;b++)isNull(this._googleFonts[this.fontsToLoad[b]])||a.push(this._googleFonts[this.fontsToLoad[b]]);0<a.length?(WebFontConfig={google:{families:a}},a=document.createElement("script"),a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",a.type="text/javascript",a.async="true",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)):document.getElementsByTagName("html")[0].className+=
" wf-active"};function POAnimStep(){this.angle=this.scaleY=this.scaleX=this.y=this.x=0;this.easing="linear";this.delay=this.opacity=this.duration=0;this.initFromJSON=function(a){this.x=a.x;this.y=a.y;this.scaleX=a.scaleX;this.scaleY=a.scaleY;this.angle=a.angle;this.opacity=a.opacity;this.duration=a.duration;this.delay=a.delay;this.easing=a.easing}}
function PCObj(a){this.zIndex=this.opacity=this.angle=this.scaleY=this.scaleX=this.y=this.x=this.id=0;this.dco="";this.type="PCObj";this.kObj;this.cEvent={};this.cATrack={};this.steps=[];a=isNull(a)?{}:a;this.set(a)}PCObj.prototype.set=function(a){for(var b=Object.keys(a),c=0;c<b.length;c++)isNull(this[b[c].toString()])||(this[b[c].toString()]=a[b[c]]);this.parseStep()};PCObj.prototype.initFromJSON=function(a){this.set(a)};
PCObj.prototype.parseStep=function(){for(var a=[],b=0;b<this.steps.length;b++){var c=new POAnimStep;c.initFromJSON(this.steps[b]);a[a.length]=c}this.steps=a};PCObj.prototype.bindClickEventToKObj=function(){if(!isNull(this.cEvent.click))this.kObj.on("click tap",function(){var a=Object.keys(this.attrs.cEvent.click);if(1===a.length)switch(a[0]){case "time":jumpToTime(this.attrs.cEvent.click[a[0]])}});if(!isNull(this.cATrack.clickTag))this.kObj.on("click tap",function(){InnityHTMLAd.click(this.attrs.cATrack.clickTag)})};
PCObj.prototype.getPreviewObj=function(){console.error("Warning - PCObj: Children class must override this (getPreviewObj) function!");return this.kObj};PCObj.prototype.getDowngradePreviewEl=function(){console.error("Warning - PCObj: Children class need to override this (getDowngradePreviewEl) function!");return null};
PCObj.prototype.getOutputObj=function(){function a(a,b,c,d){for(var l=["transformOrigin","webkitTransformOrigin"],k=0;k<l.length;k++)isNull(a.style[l[k]])||(a.style[l[k]]="top left");l=["transform","webkitTransform"];for(k=0;k<l.length;k++)isNull(a.style[l[k]])||(a.style[l[k]]="rotate("+b+"deg) scale("+c+", "+d+")")}function b(a,b){isNull(b.clickTag)||a.addEventListener("click",function(){InnityHTMLAd.click(b.clickTag)},!1)}var c=this;0<this.steps.length&&(c=this.steps[this.steps.length-1]);var d=
this.getDowngradePreviewEl();return isNull(d)?null:(a(d,c.angle,c.scaleX,c.scaleY),isNull(this.cEvent.click),b(d,this.cATrack),d.style.position="absolute",d.style.left=c.x+"px",d.style.top=c.y+"px",d.style.opacity=c.opacity,d)};PCObj.prototype.replaceDCO=function(a){console.error("Warning - PCObj: Children class must override this (replaceDCO) function!")};function PCText(a){this.text="";this.font="Sans-serif";this.size=0;this.colour="#000000";PCObj.call(this,a);this.type="Text"}extend(PCText,PCObj);
PCText.prototype.getPreviewObj=function(){this.kObj=new Kinetic.Text({x:this.x,y:this.y,cEvent:this.cEvent,cATrack:this.cATrack,scale:{x:this.scaleX,y:this.scaleY},rotation:this.angle,opacity:this.opacity,text:this.text,fontSize:this.size,fontFamily:this.font,fill:this.colour});PCObj.prototype.bindClickEventToKObj.call(this);return this.kObj};
PCText.prototype.getDowngradePreviewEl=function(){var a=document.createElement("div");a.innerHTML=this.text;a.style.fontFamily=this.font;a.style.fontSize=this.size+"px";a.style.color=this.colour;a.style.whiteSpace="nowrap";return a};PCText.prototype.replaceDCO=function(a){this.text=a};function PCImg(a){this.url="";this.height=this.width=0;PCObj.call(this,a);this.type="Img"}extend(PCImg,PCObj);
PCImg.prototype.getPreviewObj=function(){var a=document.getElementById(this.id);this.kObj=new Kinetic.Image({x:this.x,y:this.y,cEvent:this.cEvent,cATrack:this.cATrack,scale:{x:this.scaleX,y:this.scaleY},rotation:this.angle,opacity:this.opacity,image:a,width:this.width,height:this.height});PCObj.prototype.bindClickEventToKObj.call(this);return this.kObj};
PCImg.prototype.getDowngradePreviewEl=function(){var a=document.createElement("div"),b=document.createElement("img");b.width=this.width;b.height=this.height;b.src=this.url;a.appendChild(b);return a};PCImg.prototype.replaceDCO=function(a){this.url=a};function PCVid(a){this.height=this.width=0;this.iUrl="";this.vHeight=this.vWidth=0;this.vidSrc=[];PCObj.call(this,a);this.type="Vid"}extend(PCVid,PCObj);
PCVid.prototype.getPreviewObj=function(){var a=document.getElementById(this.id);this.kObj=new Kinetic.Image({id:this.id,x:this.x,y:this.y,cEvent:this.cEvent,scale:{x:this.scaleX,y:this.scaleY},rotation:this.angle,opacity:this.opacity,image:a,width:this.width,height:this.height});a=document.getElementById("video_"+this.id);1==this.cATrack.video&&InnityHTMLAd.attachVideo(a);this.kObj.on("click tap",function(){var a=document.getElementById("videoDiv_"+this.attrs.id),c=document.getElementById("video_"+
this.attrs.id);a.onmousedown=function(){c.pause();this.style.display="none"};a.style.backgroundColor="rgba(0, 0, 0, 0.5)";a.style.width="100%";a.style.textAlign="center";a.style.margin="auto";a.style.display="";a.style.left="0px";a.style.top="0px";a.style.zIndex=100;c.style.zIndex=1E3;c.onmousedown=function(a){a.stopPropagation()};c.play()});return this.kObj};
PCVid.prototype.getDowngradePreviewEl=function(){var a=document.createElement("div"),b=document.createElement("img");b.width=this.width;b.height=this.height;b.src=this.iUrl;a.appendChild(b);return a};PCVid.prototype.replaceDCO=function(a){this.url=a};function PCInviBtn(a){this.width=100;this.height=50;PCObj.call(this,a);this.type="InviBtn"}extend(PCInviBtn,PCObj);
PCInviBtn.prototype.getPreviewObj=function(){this.kObj=new Kinetic.Rect({x:this.x,y:this.y,cEvent:this.cEvent,cATrack:this.cATrack,scale:{x:this.scaleX,y:this.scaleY},rotation:this.angle,opacity:this.opacity,width:this.width,height:this.height});PCObj.prototype.bindClickEventToKObj.call(this);return this.kObj};PCInviBtn.prototype.getDowngradePreviewEl=function(){var a=document.createElement("div");a.style.width=this.width+"px";a.style.height=this.height+"px";return a};
function AnimationEngine(a,b,c,d){function e(){for(var a=0;a<h.length;a++){var b=h[a],c=b.steps;p[b.id]=[];for(var d=0;d<c.length-1;d++){for(var e=b.id,f=c[d],g=c[d+1],k=p[e].length,l=60*g.delay+k;k<l;k++)p[e][k]={x:f.x,y:f.y,scaleX:f.scaleX,scaleY:f.scaleY,angle:f.angle,opacity:f.opacity};for(var l=void 0,k=p[e].length,n=60*g.duration,s=0;s<=n;s++){isNull(l)&&(l={x:f.x,y:f.y,scaleX:f.scaleX,scaleY:f.scaleY,angle:f.angle,opacity:f.opacity});for(var q in l)l[q]=easeHelper.getEasingFunction(g.easing)(s,
f[q],g[q]-f[q],n),isNaN(l[q])&&(l[q]=f[q]);p[e][s+k]={x:l.x,y:l.y,scaleX:l.scaleX,scaleY:l.scaleY,angle:l.angle,opacity:l.opacity}}}m<p[b.id].length&&(m=p[b.id].length)}}function f(){s>m?(cancelAnimationFrame(q),"function"===typeof l&&l()):(q=requestAnimationFrame(f),g(s),k.draw(),s++)}function g(a){for(var b=0;b<h.length;b++){var c=a;a>=p[h[b].id].length&&(c=p[h[b].id].length-1,0===p[h[b].id].length&&(c=0));c=p[h[b].id][c];if(!isNull(c)){var d=h[b].kObj;d.setX(c.x);d.setY(c.y);d.setScale(c.scaleX,
c.scaleY);d.setRotationDeg(c.angle);d.setOpacity(c.opacity)}}}this.runEngine=function(){s=0;f()};this.calcTweens=e;this.gotoFrame=function(a){0>a||(g(a),k.draw())};this.startFrom=function(a){s=a;f()};this.stop=function(){cancelAnimationFrame(q)};var h=c,l=d,k,n=new Kinetic.Layer,p={},s=0,m=0,q=0;k=new Kinetic.Stage({container:a,fill:"lightcyan"});k.setWidth(b.canvas.width);k.setHeight(b.canvas.height);(function(){for(var a=0;a<h.length;a++)n.add(h[a].getPreviewObj())})();k.add(n);e()}
function FallbackEngine(){this.runEngine=function(){var a=document.getElementById("myCanvas");a.innerHTML="";a.style.width=importedJSONObject.canvas.width+"px";a.style.height=importedJSONObject.canvas.height+"px";a.style.position="relative";a.style.overflow="hidden";for(var b=0;b<pCObjsArr.length;b++){var c=pCObjsArr[b].getOutputObj();isNull(c)||a.appendChild(c)}}}
function PreviewEngine(a,b,c,d,e){function f(a,b){var c=document.createElement("img");c.setAttribute("id",a);c.setAttribute("src",b);document.getElementById("imgHiddenArea").appendChild(c);q++;c.onload=function(){q--;this.onload=void 0}}function g(){0===q&&0<document.getElementsByClassName("wf-active").length&&(clearInterval(t),m.runEngine())}this.runEngine=g;this.setupTweens=function(){m.calcTweens()};this.gotoFrame=function(a){m.gotoFrame(a)};this.startFrom=function(a){m.startFrom(a)};this.stop=
function(){m.stop()};this.fromDCO=function(a){if(!isNull(a))for(var b=Object.keys(a),c=0;c<b.length;c++)isNull(k[b[c]])||k[b[c]].replaceDCO(a[b[c]]);for(a=0;a<l.length;a++)if(b=l[a],b instanceof PCImg)f(b.id,b.url);else if(b instanceof PCVid){f(b.id,b.iUrl);var d=b,b=document.createElement("div");b.setAttribute("id","videoDiv_"+d.id);b.style.position="absolute";b.style.display="none";c=document.createElement("video");c.setAttribute("id","video_"+d.id);c.setAttribute("width",d.vWidth);c.setAttribute("height",
d.vHeight);c.setAttribute("controls","");if(!isNull(d.vidSrc))for(var d=d.vidSrc,e={".webm":"video/webm",".m4v":"video/x-m4v"},q=Object.keys(e),z=0;z<d.length;z++)for(var B=d[z],A=0;A<q.length;A++)if(-1<B.toLowerCase().indexOf(q[A])){var C=document.createElement("source");C.setAttribute("src",B);C.setAttribute("type",e[q[A]]);c.appendChild(C);break}b.appendChild(c);document.getElementById("vidHiddenArea").appendChild(b)}else b instanceof PCText&&fontHelper.addFont(b.font);fontHelper.request();a=document.createElement("canvas");
m=a.getContext&&a.getContext("2d")?new AnimationEngine(n,h,l,s):new FallbackEngine;p&&(t=setInterval(g,300));isNull(s)};var h={},l=[],k=[],n=b,p=!0,s=e,m,q=0,t;(function(a){try{h=JSON.parse(a.json_data),p=a.is_auto_play}catch(b){console.error("Invalid JSON format.")}})(a);(function(){for(var a=0;a<h.object.length;a++){var b;a:if(b=h.object[a],isNull(b.type))b=void 0;else{var c=void 0;switch(b.type){case "Text":c=new PCText;break;case "Img":c=new PCImg;break;case "InviBtn":c=new PCInviBtn;break;case "Vid":c=
new PCVid;break;default:b=null;break a}c.initFromJSON(b);b=c}isNull(b)||(l[l.length]=b,""!==b.dco&&(k[b.dco]=b))}})()};